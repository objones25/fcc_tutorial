<% if user_signed_in? %>
  <% if notice %>
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      <i class="bi bi-check-circle me-2"></i>
      <%= notice %>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  <% end %>

  <% content_for :title, "Friends" %>

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Friends</h1>
    <%= link_to "New Friend", new_friend_path, class: "btn btn-primary" %>
  </div>

  <div class="table-responsive">
    <table class="table table-hover table-striped">
      <thead class="table-dark">
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Email</th>
          <th scope="col">Phone</th>
          <th scope="col">Twitter</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @friends.each do |friend| %>
          <% if friend.user == current_user %>
          <tr>
            <td><%= link_to "#{friend.first_name} #{friend.last_name}", friend, class: "text-decoration-none" %></td>
            <td><%= friend.email %></td>
            <td><%= friend.phone %></td>
            <td><%= friend.twitter %></td>
            <td>
              <%= link_to "Delete", friend_path(friend), method: :delete, 
                          class: "btn btn-sm btn-outline-danger",
                          confirm: "Are you sure?",
                          data: { turbo_method: :delete } %>
            </td>
          </tr>
        <% end %>
        <% end %>
        <% if @friends.empty? %>
          <tr>
            <td colspan="5" class="text-center text-muted py-4">
              <em>No friends added yet. <%= link_to "Add your first friend!", new_friend_path, class: "text-decoration-none" %></em>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <% content_for :title, "Welcome" %>
  <h1>Hello World</h1>
  <p>This is my first Rails webpage</p>
  <div class="mt-4">
    <p>Please <%= link_to "sign in", new_user_session_path, class: "text-decoration-none" %> or <%= link_to "sign up", new_user_registration_path, class: "text-decoration-none" %> to access your friends list.</p>
  </div>
<% end %>
